c3db0f07b7eed415c8167665168a184a
"use strict";

const Validator = require('validator');
const isEmpty = require('is-empty');
module.exports = function validateLoginInput(data) {
  const errors = {};

  // Convert empty fields to an empty string so we can use validator functions
  data.email = !isEmpty(data.email) ? data.email : '';
  data.password = !isEmpty(data.password) ? data.password : '';

  // Email checks
  if (Validator.isEmpty(data.email)) {
    errors.email = 'Email field is required';
  } else if (!Validator.isEmail(data.email)) {
    errors.email = 'Email is invalid';
  }
  // Password checks
  if (Validator.isEmpty(data.password)) {
    errors.password = 'Password field is required';
  }
  return {
    errors,
    isValid: isEmpty(errors)
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJWYWxpZGF0b3IiLCJyZXF1aXJlIiwiaXNFbXB0eSIsIm1vZHVsZSIsImV4cG9ydHMiLCJ2YWxpZGF0ZUxvZ2luSW5wdXQiLCJkYXRhIiwiZXJyb3JzIiwiZW1haWwiLCJwYXNzd29yZCIsImlzRW1haWwiLCJpc1ZhbGlkIl0sInNvdXJjZXMiOlsibG9naW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVmFsaWRhdG9yID0gcmVxdWlyZSgndmFsaWRhdG9yJyk7XG5jb25zdCBpc0VtcHR5ID0gcmVxdWlyZSgnaXMtZW1wdHknKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB2YWxpZGF0ZUxvZ2luSW5wdXQoZGF0YSkge1xuICBjb25zdCBlcnJvcnMgPSB7fTtcblxuICAvLyBDb252ZXJ0IGVtcHR5IGZpZWxkcyB0byBhbiBlbXB0eSBzdHJpbmcgc28gd2UgY2FuIHVzZSB2YWxpZGF0b3IgZnVuY3Rpb25zXG4gIGRhdGEuZW1haWwgPSAhaXNFbXB0eShkYXRhLmVtYWlsKSA/IGRhdGEuZW1haWwgOiAnJztcbiAgZGF0YS5wYXNzd29yZCA9ICFpc0VtcHR5KGRhdGEucGFzc3dvcmQpID8gZGF0YS5wYXNzd29yZCA6ICcnO1xuXG4gIC8vIEVtYWlsIGNoZWNrc1xuICBpZiAoVmFsaWRhdG9yLmlzRW1wdHkoZGF0YS5lbWFpbCkpIHtcbiAgICBlcnJvcnMuZW1haWwgPSAnRW1haWwgZmllbGQgaXMgcmVxdWlyZWQnO1xuICB9IGVsc2UgaWYgKCFWYWxpZGF0b3IuaXNFbWFpbChkYXRhLmVtYWlsKSkge1xuICAgIGVycm9ycy5lbWFpbCA9ICdFbWFpbCBpcyBpbnZhbGlkJztcbiAgfVxuICAvLyBQYXNzd29yZCBjaGVja3NcbiAgaWYgKFZhbGlkYXRvci5pc0VtcHR5KGRhdGEucGFzc3dvcmQpKSB7XG4gICAgZXJyb3JzLnBhc3N3b3JkID0gJ1Bhc3N3b3JkIGZpZWxkIGlzIHJlcXVpcmVkJztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZXJyb3JzLFxuICAgIGlzVmFsaWQ6IGlzRW1wdHkoZXJyb3JzKVxuICB9O1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFDdEMsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBRW5DRSxNQUFNLENBQUNDLE9BQU8sR0FBRyxTQUFTQyxrQkFBa0JBLENBQUNDLElBQUksRUFBRTtFQUNqRCxNQUFNQyxNQUFNLEdBQUcsQ0FBQyxDQUFDOztFQUVqQjtFQUNBRCxJQUFJLENBQUNFLEtBQUssR0FBRyxDQUFDTixPQUFPLENBQUNJLElBQUksQ0FBQ0UsS0FBSyxDQUFDLEdBQUdGLElBQUksQ0FBQ0UsS0FBSyxHQUFHLEVBQUU7RUFDbkRGLElBQUksQ0FBQ0csUUFBUSxHQUFHLENBQUNQLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDRyxRQUFRLENBQUMsR0FBR0gsSUFBSSxDQUFDRyxRQUFRLEdBQUcsRUFBRTs7RUFFNUQ7RUFDQSxJQUFJVCxTQUFTLENBQUNFLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDRSxLQUFLLENBQUMsRUFBRTtJQUNqQ0QsTUFBTSxDQUFDQyxLQUFLLEdBQUcseUJBQXlCO0VBQzFDLENBQUMsTUFBTSxJQUFJLENBQUNSLFNBQVMsQ0FBQ1UsT0FBTyxDQUFDSixJQUFJLENBQUNFLEtBQUssQ0FBQyxFQUFFO0lBQ3pDRCxNQUFNLENBQUNDLEtBQUssR0FBRyxrQkFBa0I7RUFDbkM7RUFDQTtFQUNBLElBQUlSLFNBQVMsQ0FBQ0UsT0FBTyxDQUFDSSxJQUFJLENBQUNHLFFBQVEsQ0FBQyxFQUFFO0lBQ3BDRixNQUFNLENBQUNFLFFBQVEsR0FBRyw0QkFBNEI7RUFDaEQ7RUFFQSxPQUFPO0lBQ0xGLE1BQU07SUFDTkksT0FBTyxFQUFFVCxPQUFPLENBQUNLLE1BQU07RUFDekIsQ0FBQztBQUNILENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=